(this.webpackJsonpOSM_ilce=this.webpackJsonpOSM_ilce||[]).push([[0],{108:function(e,t,n){},109:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var r=n(11),a=n(39),o=n.n(a),i=n(83),c=n.n(i),s=(n(108),n.p,n(109),n(59)),l=n(60),u=n(55),h=n(61),d=n(71),p=(n(110),n(86)),f=n(81),j=n(70),b=n(115),v=n(116),m=n(5),g=n(87),O=n(51),y=n.n(O),x=n(74),k=n(47),S=n(78),w=n(63);function C(e,t,n){return P.apply(this,arguments)}function P(){return(P=Object(x.a)(y.a.mark((function e(t,n,r){var a,o,i,c,s,l,u,h;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.sinir,o=E(a),i=N(o),c=i[0],i[1],"https://z.overpass-api.de/api/interpreter",e.next=8,G(c,"https://z.overpass-api.de/api/interpreter");case 8:s=e.sent,l=F(s,n),u=l[0],h=l[1],r[0]=u,r[1]=h,r[2]={},r[2].bank=u.filter((function(e){return"bank"===e.getProperties().tags.amenity})),r[2].school=u.filter((function(e){return"school"===e.getProperties().tags.amenity})),r[2].place_of_worship=u.filter((function(e){return"place_of_worship"===e.getProperties().tags.amenity}));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){var t=[e[1],e[0],e[3],e[2]];return JSON.stringify(t[0])+","+JSON.stringify(t[1])+","+JSON.stringify(t[2])+","+JSON.stringify(t[3])}function N(e){return["[out:json] [bbox:"+e+'];(  relation["admin_level"=6]["type"= "boundary"]["boundary"= "administrative"]; map_to_area->.a;  (node(area.a)[amenity];););  out geom; ',"[out:json] [bbox:"+e+'];(  node["amenity"];);  out geom; ']}function G(e,t){return _.apply(this,arguments)}function _(){return(_=Object(x.a)(y.a.mark((function e(t,n){var r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{method:"POST",body:t});case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.next=8,a;case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return Object(m.o)(Object.values(e).reverse(),"EPSG:4326","EPSG:3857")}function M(e,t){var n=e.tags.name,r=e.id,a=function(e){var t=[],n=e.pop(),r=n.geometry.map((function(e){return Object(m.o)(Object.values(e).reverse(),"EPSG:4326","EPSG:3857")}));for(t.push(r);JSON.stringify(t.flat()[0])!==JSON.stringify(t.flat()[t.flat().length-1]);){var a=t.flat()[t.flat().length-1],o=e.findIndex((function(e){return JSON.stringify(J(e.geometry[0]))==JSON.stringify(a)}));-1==o?(o=e.findIndex((function(e){return JSON.stringify(J(e.geometry[e.geometry.length-1]))==JSON.stringify(a)})),r=(n=e.splice(o,1))[0].geometry.map((function(e){return Object(m.o)(Object.values(e).reverse(),"EPSG:4326","EPSG:3857")})),t.push(r.reverse())):(r=(n=e.splice(o,1))[0].geometry.map((function(e){return Object(m.o)(Object.values(e).reverse(),"EPSG:4326","EPSG:3857")})),t.push(r))}return t}(function(e){var t=[];return e.members.forEach((function(e,n,r){"way"===e.type&&t.push(e)})),t}(e)).flat(),o=new k.a([a]),i=t.filter((function(e){return o.intersectsCoordinate(e.getGeometry().getCoordinates())})),c=i.filter((function(e){return"bank"===e.getProperties().tags.amenity})),s=i.filter((function(e){return"school"===e.getProperties().tags.amenity})),l=i.filter((function(e){return"place_of_worship"===e.getProperties().tags.amenity}));return new S.a({geometry:new k.a([a]),name:n,id:r,noktalar:i,bank:c,okullar:s,camiler:l})}function F(e,t){var n=e.elements,r=function(e){return e.filter((function(e){return"relation"===e.type}))}(n),a=function(e){var t=[];return e.forEach((function(e){var n=[e.lon,e.lat],r=Object(m.o)(n,"EPSG:4326","EPSG:3857"),a=e.id,o=e.tags,i=e.tags.name,c=new S.a({geometry:new w.a(r),id:a,tags:o,name:i});t.push(c)})),t}(function(e){return e.filter((function(e){return"node"===e.type}))}(n)),o=[];return r.forEach((function(e){var n=M(e,a);t.addFeature(n),o.push(n)})),[a,o]}var T=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).state={noktalar:r.props.noktalar,poligon:r.props.poligon},r}return Object(l.a)(n,[{key:"poligonToTable",value:function(e){return e.map((function(e,t){var n=e.values_,a=(n.geometry,n.name),o=n.id,i=(n.noktalar,n.bank),c=n.okullar,s=n.camiler;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:o}),Object(r.jsx)("td",{children:a}),Object(r.jsx)("td",{children:i.length}),Object(r.jsx)("td",{children:c.length}),Object(r.jsx)("td",{children:s.length})]},o)}))}},{key:"render",value:function(){return Object(r.jsx)("div",{children:Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"OSM id"}),Object(r.jsx)("th",{children:"District Name"}),Object(r.jsx)("th",{children:"Number of banks"}),Object(r.jsx)("th",{children:"Number of Schools"}),Object(r.jsx)("th",{children:"Number of Place of Worship"})]})}),Object(r.jsx)("tbody",{children:this.poligonToTable(this.state.poligon)})]})})}}]),n}(a.Component),z=n(88),D=n(21),I=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(u.a)(r)),r.closer=r.closer.bind(Object(u.a)(r)),r.overlayContent=r.overlayContent.bind(Object(u.a)(r)),r.veri=[],r.overl=o.a.createRef(),r.source=new f.a({}),r.noktasource=new f.a({}),r.state={center:Object(m.d)([28.97953,41.015137]),zoom:12,data:!1,poligonlar:[],noktalar:[],sinir:[28.8059569,40.9778498,29.091700499999998,41.10772969999999],filtre:"",overlay:!1};var a=new b.a({source:r.source}),i=new b.a({source:r.noktasource});return r.overlay1=void 0,r.olmap=new p.a({target:null,layers:[new v.a({source:new g.a}),a,i],view:new j.a({center:r.state.center,zoom:r.state.zoom})}),r}return Object(l.a)(n,[{key:"updateMap",value:function(){this.olmap.getView().setCenter(this.state.center),this.olmap.getView().setZoom(this.state.zoom)}},{key:"componentDidMount",value:function(){var e=this;this.olmap.setTarget("map"),this.olmap.on("moveend",(function(){var t=e.olmap.getView().getCenter(),n=e.olmap.getView().getZoom(),r=Object(m.p)(e.olmap.getView().calculateExtent(),"EPSG:3857","EPSG:4326");e.setState({sinir:r,center:t,zoom:n})}));document.getElementById("popup");this.overlay1=new z.a({element:this.overl.current,autoPan:!0,autoPanAnimation:{duration:250}}),this.olmap.addOverlay(this.overlay1),this.olmap.on("singleclick",(function(t){var n=e.olmap.forEachFeatureAtPixel(t.pixel,(function(e){if("Point"===e.getGeometry().getType())return e}));if(n){var r=n.getGeometry().getCoordinates(),a=n.getProperties().name;e.setState({overlay:!0,overlaycont:a}),e.overlay1.setPosition(r)}else e.closer();var o=t.coordinate;Object(D.f)(Object(m.l)(o))}))}},{key:"componentDidUpdate",value:function(e,t,n){if(!1===t.data&&!0===this.state.data){document.getElementById("popup");this.overlay1.setElement(this.overl.current)}}},{key:"useract",value:function(){this.setState({data:!0})}},{key:"cleaning",value:function(){console.log("data temizli\u011fi ba\u015fl\u0131yor..."),this.setState({data:!1,poligonlar:[],noktalar:[]}),this.source.clear(),this.noktasource.clear()}},{key:"handleChange",value:function(e){var t=this,n=e.target.value;this.setState({filtre:n}),this.noktasource.clear(),this.veri[2][n].forEach((function(e){t.noktasource.addFeature(e)}))}},{key:"closer",value:function(){this.overlay1.setPosition(void 0),this.setState({overlay:!1})}},{key:"overlayContent",value:function(e){var t=this;if(e.overlay){var n=e.overlaycont;return Object(r.jsxs)("div",{children:[Object(r.jsxs)("p",{children:["Name: ",n," "]}),Object(r.jsx)("a",{href:"#",id:"popup-closer",className:"ol-popup-closer",onClick:function(){return t.closer()}})]})}return null}},{key:"render",value:function(){var e=this;return this.updateMap(),this.state.data?Object(r.jsxs)("div",{id:"main",children:[Object(r.jsx)("div",{id:"map",style:{width:"100%",height:"360px"}}),Object(r.jsx)("button",{onClick:function(t){e.source.clear(),e.noktasource.clear(),C(e.state,e.source,e.veri)},children:"Request OSM(OpenStreetMap) data with bounding box"}),Object(r.jsx)("button",{onClick:function(t){return e.cleaning()},children:" Delete rendered data"}),Object(r.jsxs)("form",{children:[" Choose to render points :",Object(r.jsx)("input",{type:"radio",value:"place_of_worship",id:"worship",onChange:this.handleChange,name:"noktalar"}),"            ",Object(r.jsx)("label",{htmlFor:"worship",children:"Place of worship"}),Object(r.jsx)("input",{type:"radio",value:"school",id:"school",onChange:this.handleChange,name:"noktalar"}),"            ",Object(r.jsx)("label",{htmlFor:"school",children:"Schools"}),Object(r.jsx)("input",{type:"radio",value:"bank",id:"bank",onChange:this.handleChange,name:"noktalar"}),"            ",Object(r.jsx)("label",{htmlFor:"bank",children:"Banks"})]}),Object(r.jsx)(T,{noktalar:this.veri[0],poligon:this.veri[1]}),Object(r.jsxs)("div",{children:[" ",Object(r.jsx)("div",{id:"popup",className:"ol-popup",ref:this.overl,children:Object(r.jsx)("div",{id:"popup-content",children:Object(r.jsx)(this.overlayContent,{overlay:this.state.overlay,overlaycont:this.state.overlaycont,children:" "})})})," "]})]}):Object(r.jsxs)("div",{id:"main",children:[Object(r.jsx)("div",{id:"map",style:{width:"100%",height:"360px"}}),Object(r.jsx)("button",{onClick:function(t){C(e.state,e.source,e.veri)},children:"Request OSM(OpenStreetMap) data with bounding box"}),Object(r.jsx)("button",{onClick:function(t){return e.cleaning()},children:"Delete rendered data"}),Object(r.jsx)("button",{onClick:function(t){return e.useract()},children:"Create table from requested data"}),Object(r.jsxs)("div",{children:[" ",Object(r.jsx)("div",{id:"popup",className:"ol-popup",ref:this.overl,children:Object(r.jsx)("div",{id:"popup-content",children:Object(r.jsx)(this.overlayContent,{overlay:this.state.overlay,overlaycont:this.state.overlaycont})})})," "]})]})}}]),n}(a.Component);var B=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(I,{})})},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,118)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),o(e),i(e)}))};c.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(B,{})}),document.getElementById("root")),V()}},[[112,1,2]]]);
//# sourceMappingURL=main.772d3e7e.chunk.js.map